---
title: "3.Detailed_analysis"
author: "Dennis Wiersma"
date: '2022-05-16'
output: 
  pdf_document:
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
```

# Comparing simulation data with experimental data for two dosis

```{r}
data <- read.csv("MPL.csv", na.strings = "NA")

median_MPL_01 <- median(data$MPL_conc[data$dose==0.1], na.rm=T)
median_MPL_03 <- median(data$MPL_conc[data$dose==0.3], na.rm=T)

D01 = median_MPL_01 * 1000 / 374.471
D03 = median_MPL_03 * 1000 / 374.471

```

# Assignment 1

```{r}
parameters <- c(
  k.s_Rm = 2.90,
  IC.50_Rm = 26.2,
  k.on = 0.00329,
  k.T = 0.63,
  k.re = 0.57,
  Rf = 0.49,
  k.d_R = 0.0572,
  k.d_Rm = 0.612,
  k.s_r = 3.22,
  D = D01
)

state <- c(
  R.m0 = 4.74,
  R.0 = 267,
  DR = 0,
  DRN = 0
)

# glucocorticoid receptor dynamics
GRD <- function(t, state, parameters){
  with(as.list(c(state, parameters)),{
    
    dR.m <- k.s_Rm * (1 - DRN / (IC.50_Rm + DRN) - k.d_Rm * R.m0)
    
    dR <- k.s_r * R.m0 + Rf * k.re * DRN - k.on * D * R.0 - k.d_R * R.0
    
    dDR <- k.on * D * R.0 - k.T * DR
    
    dDRN <- k.T * DR - k.re * DRN
    
    return(list(c(dR.m, dR, dDR, dDRN)))
  }
  )
}

# Duration of 2 days, defined in hours
times <- seq(0, 168)

out <- ode(y = state, times = times, func = GRD, parms = parameters)

par(1,2)
plot(data$Free_receptor)
lines(out[,3])
plot(data$mRNA)
lines(out[,2])
```

